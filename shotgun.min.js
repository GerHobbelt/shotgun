/*!
 * Name: shotgun.js
 * License: MIT
 * Version: 3.1
 * URL: https://github.com/jgnewman/shotgun
 */
(function(e){"use strict";function f(e){return e[0]}function l(e){return e[e.length-1]}function c(e){return e.slice(0,e.length-1)}function h(){var e="",t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz",r;e+=(new Date).getTime();n+=1;e+="-"+n+"-";if(n===9999999){n=999999}for(r=0;r<25;r+=1){e+=t[Math.floor(Math.random()*t.length)]}return e}function p(e,t){var n,r=e.length,i=[];for(n=0;n<r;n+=1){i.push(t(e[n],n))}return i}function d(e,t){var n,r,s={};for(n in e){if(Object.prototype.hasOwnProperty.call(e,n)){r=t(e[n],n);if(r!==i){s[n]=r}}}return s}function v(){}function m(){}function g(e){return e.slice(0,9)==="_internal"}function y(e,t,n){function s(){}var i;if(t===u&&n){throw new Error("Attempt to subscribe to an internal event without first registering the event.")}i=h();r[i]={};s.prototype={_dirEvents:r[i],_dirEventsKey:i,_parentDir:t,_dirName:e};return new s}function b(e,t,n,r){var s=e._dirEvents;if(t){s[t].apply(null,n);return true}d(s,function(e){e.apply(null,n)});if(!r){return true}return d(e,function(e,s){if(f(s)==="_"){return i}return b(e,t,n,r)})}function w(){if(/in/.test(e.document.readyState)){return e.setTimeout(w,100)}s=true;return a.fire("docReady",[e])}var t=t||null,n=999999,r={},i={},s=false,o,u,a;o=new v;u=new m;a={fire:function(e,t,n){var r,i,s,a,f;if(typeof t==="string"){i=[];s=t}else{i=t;s=n}if(g(e)){e=e.slice(10);f=u}else{f=o}if(l(e)==="*"){a=true;r=c(c(e)).split("/")}else{r=e.split("/")}p(r,function(e){f=f[e]});if(!f){return false}return b(f,s,i,a)},listen:function(e,t,n){var r=n||h(),i,s;if(g(e)){e=e.slice(10);s=u}else{s=o}i=e.split("/");p(i,function(e){s[e]=s[e]||y(e,s,true);s=s[e]});s._dirEvents[r]=t;this.fire("_internal/newListener",[e,t,r]);return r},registerInternal:function(){p(arguments,function(e){var t=u,n=e.split("/");p(n,function(e){t[e]=t[e]||y(e,t,false);t=t[e]})});return true},remove:function(e,t){var n,i;if(g(e)){e=e.slice(10);i=u}else{i=o}n=e.split("/");p(n,function(e){i=i[e]});if(t){delete i._dirEvents[t];this.fire("_internal/rmListener",[e,t]);return true}delete r[i._dirEventsKey];delete i._parentDir[i._dirName];this.fire("_internal/rmEvent",[e]);return true},attempt:function(e,t,n){var r,i,s;if(typeof e==="function"){i=e;s=t}else{r=e;i=t;s=n}try{i()}catch(o){if(r){this.fire(r,[o,i],s)}this.fire("_internal/tryError",[o,i],s)}},getEvents:function(){return o},getInternalEvents:function(){return u},docReady:function(t){this.listen("docReady",t);if(s){t(e)}}};a.registerInternal("newListener","rmEvent","rmListener","tryError");if(e.constructor.name==="Window"){w()}if(e.define&&typeof e.define==="function"&&e.define.amd){e.define(a)}else if(t&&t.exports){t.exports=a}else{e.SHOTGUN=e.SG=a}})(this);